function [dp] = out_dp3(q,dq)

  dp(1,1)=dq(3)*(cos(q(1) + q(2) + q(3)) + cos(q(1) + q(2)) + cos(q(1)) - 2*cos(q(1))*cos(q(2)) +...
          sin(q(1))*sin(q(2)) + cos(q(1))*(cos(q(2)) - 1)) + dq(1)*(cos(q(1) + q(2) + q(3)) + cos(q(1) + q(2)) +...
          cos(q(1))) + dq(2)*(cos(q(1) + q(2) + q(3)) + cos(q(1) + q(2)));
  dp(2,1)=0;
  dp(3,1)=- dq(3)*(sin(q(1) + q(2) + q(3)) + sin(q(1) + q(2)) + sin(q(1)) - cos(q(1))*sin(q(2)) - 2*...
         cos(q(2))*sin(q(1)) + sin(q(1))*(cos(q(2)) - 1)) - dq(1)*(sin(q(1) + q(2) + q(3)) + sin(q(1) + q(2)) +...
          sin(q(1))) - dq(2)*(sin(q(1) + q(2) + q(3)) + sin(q(1) + q(2)));

 